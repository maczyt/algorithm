<!DOCTYPE html>
<html>
<head>
  <title>冒泡排序</title>
  <style>
    .container { display: flex; align-items: flex-end; min-height: 620px; }
    .container > div { margin: 5px; background: #add6e6; }
    div { transition: height 1s ease; }
    div.active { background: #0d8000; }
    div.ok { background: #fda800; }
  </style>
</head>
<body>
<script src="lib.js"></script>
<script type="text/javascript">
  var divs;
  function BubbleSort(array) {
    var arr = array.slice();
    var i, j;

    divs = render(arr);
    for (i = arr.length - 1; i > 0; i --) {
      for (j = 0; j < i; j ++) {
        if (arr[j] > arr[j+1]) {
          arr[j] = [arr[j+1], arr[j+1] = arr[j]][0];
          swap(t, divs, j, j + 1, arr[j], arr[j + 1]);
        }
      }
      (function (x) {
        t.add(function () {
          divs[x].className = 'ok';
          divs.splice(x, 1);
        })
      })(j)
    }
    t.add(function () {
      divs.forEach(function (div) {
        div.className = 'ok';
      })
    }, 0);
    t.run();
    return arr;
  }
  var t = new TimedQueue(1000);
  var arr = function () {
    var arr = [];
    for (var i = 0; i < 20; i ++) {
      arr.push(Math.floor(Math.random() * 20) + 1)
    }
    return arr;
  }();
  BubbleSort(arr)
</script>
</body>
</html>